---
title: 【BZOJ1901】【ZJU2112】Dynamic Rankings
date: 2016-07-27 12:00:00
tags:
---

树状数组套动态开点的权值线段树即可。

<!-- more -->

树状数组中的每个节点$i$为满足$j$在$[i−lowbit(i)+1,i]$的所有$a[j]$组成的权值线段树。

修改操作对应树状数组的修改操作，但加法变成了权值线段树的插入，减法变成了权值线段树的删除。

查询对应在$O(\log n)$棵权值线段树的加减操作的结果上查询第k小，直接同时在这$O(\log n)$棵树上走即可。

需要离散化以减小空间。时空复杂度均为$O(n \log^2 n)$。

[Code](https://github.com/q234rty/OJ-Codes/blob/master/BZOJ/1901.cpp)

